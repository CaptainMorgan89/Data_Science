import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# ğŸ“¥ Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
file_path = r"C:\Users\agkap\Desktop\hospital_data.csv"
df = pd.read_csv(file_path)

# ğŸ‘€ Î ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
print("ğŸ”¹ Î ÏÏÏ„ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î¿Ï… dataset:")
print(df.head())

# ğŸ“… ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½ ÏƒÎµ datetime
df['admission_date'] = pd.to_datetime(df['admission_date'])
df['discharge_date'] = pd.to_datetime(df['discharge_date'])

# ğŸ§® Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ length of stay (Î·Î¼Î­ÏÎµÏ‚ Ï€Î±ÏÎ±Î¼Î¿Î½Î®Ï‚)
df['length_of_stay'] = (df['discharge_date'] - df['admission_date']).dt.days

# ğŸ”¥ ÎœÎ­ÏƒÎ¿Ï‚ Ï‡ÏÏŒÎ½Î¿Ï‚ Ï€Î±ÏÎ±Î¼Î¿Î½Î®Ï‚
avg_stay = df['length_of_stay'].mean()
print(f"\nğŸ“Š ÎœÎ­ÏƒÎ¿Ï‚ Ï‡ÏÏŒÎ½Î¿Ï‚ Ï€Î±ÏÎ±Î¼Î¿Î½Î®Ï‚: {avg_stay:.2f} Î·Î¼Î­ÏÎµÏ‚")

# ğŸ“Œ Î Î¹Î¿ ÏƒÏ…Ï‡Î½Î­Ï‚ Î´Î¹Î±Î³Î½ÏÏƒÎµÎ¹Ï‚
common_diagnoses = df['diagnosis'].value_counts().head(10)
print("\nğŸ¥ Top 10 Ï€Î¹Î¿ ÏƒÏ…Ï‡Î½Î­Ï‚ Î´Î¹Î±Î³Î½ÏÏƒÎµÎ¹Ï‚:")
print(common_diagnoses)

# ğŸ¨ Î“ÏÎ¬Ï†Î·Î¼Î± 1: ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î·Î»Î¹ÎºÎ¹ÏÎ½ Î±ÏƒÎ¸ÎµÎ½ÏÎ½
plt.figure(figsize=(10, 6))
sns.histplot(df['age'], bins=20, kde=True, color='skyblue')
plt.title('ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î—Î»Î¹ÎºÎ¯Î±Ï‚ Î‘ÏƒÎ¸ÎµÎ½ÏÎ½')
plt.xlabel('Î—Î»Î¹ÎºÎ¯Î±')
plt.ylabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î‘ÏƒÎ¸ÎµÎ½ÏÎ½')
plt.grid(True)
plt.tight_layout()
plt.show()

# ğŸ¨ Î“ÏÎ¬Ï†Î·Î¼Î± 2: Top 10 Î”Î¹Î±Î³Î½ÏÏƒÎµÎ¹Ï‚
plt.figure(figsize=(12, 6))
sns.barplot(x=common_diagnoses.values, y=common_diagnoses.index, palette='viridis')
plt.title(' Top 10 Î Î¹Î¿ Î£Ï…Ï‡Î½Î­Ï‚ Î”Î¹Î±Î³Î½ÏÏƒÎµÎ¹Ï‚')
plt.xlabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î ÎµÏÎ¹ÏƒÏ„Î±Ï„Î¹ÎºÏÎ½')
plt.ylabel('Î”Î¹Î¬Î³Î½Ï‰ÏƒÎ·')
plt.tight_layout()
plt.show()

# ğŸ“… ÎŸÎ¼Î±Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î±Î½Î¬ Î¼Î®Î½Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚
df['year_month'] = df['admission_date'].dt.to_period('M')
monthly_admissions = df['year_month'].value_counts().sort_index()

# ğŸ¨ Î“ÏÎ¬Ï†Î·Î¼Î± 3: Î¤Î¬ÏƒÎ· Î•Î¹ÏƒÎ±Î³Ï‰Î³ÏÎ½ Î±Î½Î¬ ÎœÎ®Î½Î±
plt.figure(figsize=(12, 6))
sns.lineplot(x=monthly_admissions.index.astype(str), y=monthly_admissions.values, marker='o', color='orange')
plt.title('Î¤Î¬ÏƒÎ· Î•Î¹ÏƒÎ±Î³Ï‰Î³ÏÎ½ Î‘Î½Î¬ ÎœÎ®Î½Î±')
plt.xlabel('ÎœÎ®Î½Î±Ï‚')
plt.ylabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³ÏÎ½')
plt.xticks(rotation=45)
plt.grid(True)
plt.tight_layout()
plt.show()
