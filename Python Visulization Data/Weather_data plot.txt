import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Φόρτωση δεδομένων
file_path = r"C:\Users\agkap\Desktop\Weather_data.csv"
df = pd.read_csv(file_path)

# Μετατροπή της στήλης 'date' σε datetime (MM/DD/YYYY)
df['date'] = pd.to_datetime(df['date'], dayfirst=False)

# Υπολογισμός μέσης θερμοκρασίας ανά ημέρα
df['avg_temp'] = (df['min_temp'] + df['max_temp']) / 2

# Δημιουργία στήλης 'year_month' με μορφή 'YYYY-MM' για ομαδοποίηση
df['year_month'] = df['date'].dt.to_period('M')

# Ομαδοποίηση κατά μήνα & υπολογισμός μέσου όρου μέσης θερμοκρασίας
monthly_avg_temp = df.groupby('year_month')['avg_temp'].mean()

print("\nΜηνιαίος Μέσος Όρος Θερμοκρασίας:\n", monthly_avg_temp)

# Βρες τον πιο ζεστό και πιο κρύο μήνα
hottest_month = monthly_avg_temp.idxmax()
coldest_month = monthly_avg_temp.idxmin()
print(f"\nΠιο ζεστός μήνας: {hottest_month} με {monthly_avg_temp[hottest_month]:.2f} °C")
print(f"Πιο κρύος μήνας: {coldest_month} με {monthly_avg_temp[coldest_month]:.2f} °C")

# Γράφημα 1: Γραμμή με μηνιαίους μέσους όρους θερμοκρασίας
plt.figure(figsize=(12,6))
sns.lineplot(x=monthly_avg_temp.index.astype(str), y=monthly_avg_temp.values, marker='o', color='orange')
plt.title('Μηνιαίος Μέσος Όρος Θερμοκρασίας')
plt.xlabel('Μήνας (Έτος-Μήνας)')
plt.ylabel('Μέση Θερμοκρασία (°C)')
plt.xticks(rotation=45)
plt.grid(True)
plt.tight_layout()
plt.show()

# Γράφημα 2: Ιστόγραμμα κατανομής μέσης ημερήσιας θερμοκρασίας
plt.figure(figsize=(10,6))
sns.histplot(df['avg_temp'], bins=40, kde=True, color='skyblue')
plt.title('Κατανομή Μέσης Ημερήσιας Θερμοκρασίας')
plt.xlabel('Μέση Θερμοκρασία (°C)')
plt.ylabel('Συχνότητα')
plt.grid(True)
plt.tight_layout()
plt.show()
