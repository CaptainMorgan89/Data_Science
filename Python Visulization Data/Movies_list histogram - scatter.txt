import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib.ticker as ticker

# 📥 Φόρτωση CSV
file_path = r"C:\Users\agkap\Desktop\Movies_list.csv"
df = pd.read_csv(file_path)

# 🧹 Καθαρισμός δεδομένων
df.dropna(inplace=True)
df['budget'] = pd.to_numeric(df['budget'], errors='coerce')
df['revenue'] = pd.to_numeric(df['revenue'], errors='coerce')
df.dropna(subset=['budget', 'revenue'], inplace=True)
df['profit'] = df['revenue'] - df['budget']

# 📦 Formatter για εκατομμύρια
def millions(x, pos):
    return f'{x*1e-6:.0f}M'
formatter = ticker.FuncFormatter(millions)

# 🎨 Histogram για το Profit σε εκατομμύρια
plt.figure(figsize=(10, 6))
plt.hist(df['profit'], bins=30, color='purple', edgecolor='black')
plt.title('Histogram of Movie Profits (σε εκατομμύρια $)')
plt.xlabel('Profit (Millions $)')
plt.ylabel('Number of Movies')
plt.gca().xaxis.set_major_formatter(formatter)
plt.grid(True)
plt.tight_layout()
plt.show()

# 🎨 Scatter Plot: Budget vs Revenue με break-even γραμμή
plt.figure(figsize=(10, 6))
sns.scatterplot(x='budget', y='revenue', data=df, hue='genre', palette='Set2')
plt.title('Budget vs Revenue (σε εκατομμύρια $)')
plt.xlabel('Budget (Millions $)')
plt.ylabel('Revenue (Millions $)')

# 🔥 Προσθήκη κόκκινης γραμμής Break Even (Revenue = Budget)
max_value = max(df['budget'].max(), df['revenue'].max())
plt.plot([0, max_value], [0, max_value], color='red', linestyle='--', linewidth=2, label='Break Even (Revenue = Budget)')

# 📦 Formatting αξόνων
plt.gca().xaxis.set_major_formatter(formatter)
plt.gca().yaxis.set_major_formatter(formatter)

plt.legend(title='Genre')
plt.grid(True)
plt.tight_layout()
plt.show()
