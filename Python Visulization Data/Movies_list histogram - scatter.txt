import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib.ticker as ticker

# ğŸ“¥ Î¦ÏŒÏÏ„Ï‰ÏƒÎ· CSV
file_path = r"C:\Users\agkap\Desktop\Movies_list.csv"
df = pd.read_csv(file_path)

# ğŸ§¹ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
df.dropna(inplace=True)
df['budget'] = pd.to_numeric(df['budget'], errors='coerce')
df['revenue'] = pd.to_numeric(df['revenue'], errors='coerce')
df.dropna(subset=['budget', 'revenue'], inplace=True)
df['profit'] = df['revenue'] - df['budget']

# ğŸ“¦ Formatter Î³Î¹Î± ÎµÎºÎ±Ï„Î¿Î¼Î¼ÏÏÎ¹Î±
def millions(x, pos):
    return f'{x*1e-6:.0f}M'
formatter = ticker.FuncFormatter(millions)

# ğŸ¨ Histogram Î³Î¹Î± Ï„Î¿ Profit ÏƒÎµ ÎµÎºÎ±Ï„Î¿Î¼Î¼ÏÏÎ¹Î±
plt.figure(figsize=(10, 6))
plt.hist(df['profit'], bins=30, color='purple', edgecolor='black')
plt.title('Histogram of Movie Profits (ÏƒÎµ ÎµÎºÎ±Ï„Î¿Î¼Î¼ÏÏÎ¹Î± $)')
plt.xlabel('Profit (Millions $)')
plt.ylabel('Number of Movies')
plt.gca().xaxis.set_major_formatter(formatter)
plt.grid(True)
plt.tight_layout()
plt.show()

# ğŸ¨ Scatter Plot: Budget vs Revenue Î¼Îµ break-even Î³ÏÎ±Î¼Î¼Î®
plt.figure(figsize=(10, 6))
sns.scatterplot(x='budget', y='revenue', data=df, hue='genre', palette='Set2')
plt.title('Budget vs Revenue (ÏƒÎµ ÎµÎºÎ±Ï„Î¿Î¼Î¼ÏÏÎ¹Î± $)')
plt.xlabel('Budget (Millions $)')
plt.ylabel('Revenue (Millions $)')

# ğŸ”¥ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎºÏŒÎºÎºÎ¹Î½Î·Ï‚ Î³ÏÎ±Î¼Î¼Î®Ï‚ Break Even (Revenue = Budget)
max_value = max(df['budget'].max(), df['revenue'].max())
plt.plot([0, max_value], [0, max_value], color='red', linestyle='--', linewidth=2, label='Break Even (Revenue = Budget)')

# ğŸ“¦ Formatting Î±Î¾ÏŒÎ½Ï‰Î½
plt.gca().xaxis.set_major_formatter(formatter)
plt.gca().yaxis.set_major_formatter(formatter)

plt.legend(title='Genre')
plt.grid(True)
plt.tight_layout()
plt.show()
